# Rapport de Tests - Simulateur DNS

**Projet**: td3-AbdelkarimDouadjia  

**Étudiant**: Abdelkarim Douadjia  

**Numéro d'étudiant**: 22506341  

**NC**: 100

---

## 1. Compilation et Construction

### Commande Maven
```bash
.\mvnw.cmd clean verify
```

**Résultat**: BUILD SUCCESS (34.945 s)

Les phases suivantes ont été exécutées avec succès :
- Clean : nettoyage des fichiers de build précédents
- Validate : vérification Checkstyle (0 violation)
- Compile : compilation de 14 fichiers source
- Test : exécution de 69 tests unitaires
- Package : création du fichier JAR

---

## 2. Résultats des Tests Unitaires

**Total : 69 tests - 100% de réussite**

[options="header"]
|===
| Classe de Test | Nombre de Tests | Échecs | Erreurs | Temps

| AdresseIpTest | 9 | 0 | 0 | 0.331s
| AppTest | 1 | 0 | 0 | 0.023s
| CommandeTest | 11 | 0 | 0 | 0.389s
| DnsAppTest | 3 | 0 | 0 | 0.035s
| DnsItemTest | 7 | 0 | 0 | 0.008s
| DnsTest | 13 | 0 | 0 | 0.449s
| DnsTuiTest | 14 | 0 | 0 | 0.153s
| NomMachineTest | 11 | 0 | 0 | 0.021s
| *TOTAL* | *69* | *0* | *0* | *1.409s*
|===

---

## 3. Validation du Code

### Checkstyle (Google Java Style Guide)
- **Violations détectées** : 0
- **Configuration** : Exécution automatique à la phase `validate`
- **Résultat** : Le code respecte intégralement le guide de style Google

---

## 4. Tests Fonctionnels

### Lancement de l'application
```bash
java -cp target/collex-1.0-SNAPSHOT.jar fr.uvsq.cprog.collex.DnsApp
```

### Scénarios testés

#### 4.1 Recherche par nom qualifié
```
> www.uvsq.fr
193.51.31.90
```
✓ Fonctionne correctement

#### 4.2 Recherche par adresse IP
```
> 193.51.31.90
www.uvsq.fr
```
✓ Fonctionne correctement

#### 4.3 Liste des machines (tri par nom)
```
> ls uvsq.fr
193.51.25.12 ecampus.uvsq.fr
193.51.31.154 poste.uvsq.fr
193.51.31.90 www.uvsq.fr
```
✓ Tri alphabétique correct

#### 4.4 Liste des machines (tri par IP avec option -a)
```
> ls -a uvsq.fr
193.51.25.12 ecampus.uvsq.fr
193.51.25.24 pikachu.uvsq.fr
193.51.31.154 poste.uvsq.fr
193.51.31.90 www.uvsq.fr
```
✓ Tri numérique correct

#### 4.5 Ajout d'une nouvelle entrée
```
> add 193.51.25.24 pikachu.uvsq.fr
Entrée DNS ajoutée : 193.51.25.24 pikachu.uvsq.fr
```
✓ L'entrée est bien ajoutée et persistée dans le fichier

#### 4.6 Détection des doublons (nom existant)
```
> add 193.51.25.90 www.uvsq.fr
ERREUR : Le nom de machine existe déjà : www.uvsq.fr
```
✓ Message d'erreur approprié

#### 4.7 Détection des doublons (IP existante)
```
> add 193.51.31.90 autre.uvsq.fr
ERREUR : L'adresse IP existe déjà : 193.51.31.90
```
✓ Message d'erreur approprié

#### 4.8 Gestion des machines inexistantes
```
> inexistant.uvsq.fr
Aucune adresse IP trouvée pour : inexistant.uvsq.fr
```
✓ Message d'erreur clair

#### 4.9 Commande quit
```
> quit
Au revoir !
```
✓ L'application se termine proprement

---

## 5. Vérification des Exigences

### Contraintes obligatoires du README.adoc

**Gestion de version**
- [x] Utilisation de Git avec commits réguliers (7 commits au total)
- [x] Messages de commit informatifs

**Build Maven**
- [x] Maven Wrapper configuré (mvnw.cmd)
- [x] Compilation Java 17
- [x] Aucune manipulation en dehors de Maven nécessaire

**Qualité du code**
- [x] Checkstyle intégré (Google Java Style Guide)
- [x] Exécution automatique à la phase validate
- [x] 0 violation détectée

**Tests unitaires**
- [x] JUnit 4.13.2
- [x] Tests pour la majorité des méthodes
- [x] 69 tests unitaires au total

**Fonctionnalités Java**
- [x] Exceptions personnalisées (DnsException)
- [x] Collections (HashMap pour les indexations)
- [x] I/O avec java.nio.file.Files
- [x] Propriétés avec java.util.Properties

### Fonctionnalités requises

**Classes du modèle**
- [x] AdresseIP : validation d'adresses IP (format 0.0.0.0 à 255.255.255.255)
- [x] NomMachine : gestion des noms qualifiés avec extraction du domaine
- [x] DnsItem : association IP ↔ nom qualifié

**Classe Dns**
- [x] Constructeur chargeant la base depuis un fichier de propriétés
- [x] getItem(AdresseIP) : recherche par IP
- [x] getItem(NomMachine) : recherche par nom
- [x] getItems(String domain) : liste des machines d'un domaine
- [x] addItem() : ajout avec détection de doublons et levée d'exception

**Persistance**
- [x] Fichier texte (format : "nom_machine adresse_ip")
- [x] Chargement au démarrage
- [x] Sauvegarde automatique à chaque ajout (commande add)
- [x] Utilisation de Files.readAllLines() et Files.write()
- [x] Chemin du fichier stocké dans application.properties

**Interface utilisateur (DnsTUI)**
- [x] nextCommande() : analyse de la saisie utilisateur
- [x] affiche() : affichage des résultats

**Pattern Commande**
- [x] Interface Commande avec méthode execute()
- [x] RechercheIpCommande : recherche par IP
- [x] RechercheNomCommande : recherche par nom
- [x] ListeDomaineCommande : liste avec options de tri (-a)
- [x] AjoutCommande : ajout avec gestion d'erreurs
- [x] QuitterCommande : sortie de l'application

**Application principale (DnsApp)**
- [x] Méthode run() avec boucle d'interaction
- [x] Récupération des commandes via DnsTUI
- [x] Exécution et affichage des résultats

**Syntaxe des commandes**
- [x] `<nom.qualifié>` : affiche l'adresse IP
- [x] `<adresse.ip>` : affiche le nom qualifié
- [x] `ls [-a] <domaine>` : liste triée (nom ou IP selon -a)
- [x] `add <ip> <nom.qualifié>` : ajout avec messages d'erreur en cas de doublon

---

## 6. Structure du Projet

### Fichiers source (14 classes)
```
src/main/java/fr/uvsq/cprog/collex/
├── AdresseIP.java
├── AjoutCommande.java
├── App.java
├── Commande.java
├── Dns.java
├── DnsApp.java
├── DnsException.java
├── DnsItem.java
├── DnsTUI.java
├── ListeDomaineCommande.java
├── NomMachine.java
├── QuitterCommande.java
├── RechercheIpCommande.java
└── RechercheNomCommande.java
```

### Fichiers de test (8 classes)
```
src/test/java/fr/uvsq/cprog/collex/
├── AdresseIpTest.java
├── AppTest.java
├── CommandeTest.java
├── DnsAppTest.java
├── DnsItemTest.java
├── DnsTest.java
├── DnsTuiTest.java
└── NomMachineTest.java
```

### Fichiers de configuration
- `pom.xml` : configuration Maven
- `src/main/resources/application.properties` : chemin de la base de données
- `dns-database.txt` : fichier de données persistantes

### État actuel de la base de données
Le fichier `dns-database.txt` contient actuellement 5 entrées :
```
ecampus.uvsq.fr 193.51.25.12
pikachu.uvsq.fr 193.51.25.24
poste.uvsq.fr 193.51.31.154
serveur.exemple.fr 10.0.0.1
www.uvsq.fr 193.51.31.90
```

Les entrées `pikachu.uvsq.fr` et `serveur.exemple.fr` ont été ajoutées lors des tests de la commande `add`, confirmant que la persistance fonctionne correctement.

---

## 7. Historique Git

```
commit 6256654 - Documentation finale du projet
commit 3e489a3 - Update App.java pour deleguer a DnsApp
commit 186bd20 - Partie 5: DnsTUI et DnsApp - Application complete
commit c9facf9 - Partie 4: Pattern Commande et implementations
commit 93e2be2 - Partie 3: Classe Dns avec persistence fichier
commit 71c1bc4 - Partie 2: Classes NomMachine et DnsItem
commit 057f9fb - Partie 1: Configuration projet et classe AdresseIP
```

Chaque commit correspond à une partie logique du développement, facilitant la traçabilité des modifications.

---

## 8. Conclusion

Ce projet implémente un simulateur DNS fonctionnel respectant toutes les spécifications du README.adoc.

**Points forts** :
- Tous les tests unitaires passent (69/69)
- Respect strict du Google Java Style Guide (0 violation Checkstyle)
- Utilisation correcte du pattern Commande
- Persistance des données fonctionnelle
- Gestion appropriée des erreurs (doublons, entrées invalides)
- Code structuré et testé

**Commandes de vérification** :
```bash
# Compilation et tests
.\mvnw.cmd clean verify

# Lancement de l'application
java -cp target/collex-1.0-SNAPSHOT.jar fr.uvsq.cprog.collex.DnsApp
```
